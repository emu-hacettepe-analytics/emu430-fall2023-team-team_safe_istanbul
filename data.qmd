---
title: "Data"

format:
  html:
    code-fold: true
    code-summary: "Show the code"
---

Datasets shown below downloaded from [Istanbul Metropolitan Municipality](data.ibb.gov.tr) website as csv and xlsx files. Separate links are also provided.

# Data Sets

1.  [Earthquake Scenario Analysis Results](https://data.ibb.gov.tr/tr/dataset/deprem-senaryosu-analiz-sonuclari/resource/9c3ac492-de4b-4245-b418-7ad3df67a193)

    In this dataset some column names has been changed. Structure and first 10 observation can be seen below. Download [R.Data](https://github.com/emu-hacettepe-analytics/emu430-fall2023-team-team_safe_istanbul/blob/master/deprem_analiz.RData) file to see the entire dataframe.

    ```{r}

    library(readr)
    deprem_analiz <- read.csv("Deprem_senaryosu_analiz_sonuÃ§lar.csv")
    colnames(deprem_analiz)[1:4] <- c("id", "ilce_adi", "mahalle_adi", "mahalle_kodu")
    str(deprem_analiz)
    head(deprem_analiz, n = 10L)
    save(deprem_analiz, file = "deprem_analiz.RData")
    ```

2.  [Neighborhood-Based Building Numbers in 2017](https://data.ibb.gov.tr/tr/dataset/mahalle-bazli-bina-analiz-verisi/resource/cef193d5-0bd2-4e8d-8a69-275c50288875)

    **toplam_bina** column is calculated and added to the last. Also, some colum names has been changed.

    ```{r}
    library(readr)
    library(dplyr)
    mahalle_bazli_bina <- read.csv("mahalle_bazli_bina_2017.csv")
    colnames(mahalle_bazli_bina) <- c("id", "ilce_adi", "mahalle_adi", "mahalle_kodu", "once_1980", "ara_1980_2000", "sonra_2000", "ara_1_4_kat", "ara_5_9_kat", "ara_9_19_kat")
    toplam_bina <- mahalle_bazli_bina %>% 
      select(ara_1_4_kat,ara_5_9_kat,ara_9_19_kat) %>%
      rowwise() %>%
      do( (.) %>% as.data.frame() %>% mutate(toplam_bina = sum(.))) %>%
      ungroup %>%
      select(toplam_bina)
    mahalle_bazli_bina <- cbind(mahalle_bazli_bina, toplam_bina)
    str(mahalle_bazli_bina)
    save(mahalle_bazli_bina, file = "mahalle_bazli_bina.RData")
    ```

    A new column has been created to examine buildings in districts separately. You can see the first 10 district that have highest number of buildings.

    ```{r}
    mahalle_bazli_bina %>% 
      group_by(ilce_adi) %>%
      summarize(ilce_bazli_bina = sum(toplam_bina)) %>%
      arrange(desc(ilce_bazli_bina)) %>%
      head(n = 10L)
    ```

    The dataset contains too much rows. Refer to [R.Data](https://github.com/emu-hacettepe-analytics/emu430-fall2023-team-team_safe_istanbul/blob/master/mahalle_bazli_bina.RData) file.

3.  [Municipality Population in 2019](https://data.ibb.gov.tr/tr/dataset/belediye-nufuslari-veri-seti/resource/c6c9b289-2824-41b3-ab3d-4fd655ed4e24)

    Structure and first 10 observation can be seen below.

    ```{r}

    library(readxl)
    nufus <- read_excel("belediye_nufuslar_2019.xlsx")
    str(nufus)
    head(nufus, n = 10L)
    save(nufus, file = "nufus.RData")
    ```

    You can also download this dataset as [R.Data](https://github.com/emu-hacettepe-analytics/emu430-fall2023-team-team_safe_istanbul/blob/master/nufus.RData) file.
